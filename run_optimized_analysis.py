"""
ìµœì í™”ëœ ìœ„ë²•ì„± ë¶„ì„ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
ëª¨ë“  ê¸°ëŠ¥ì„ í†µí•©í•˜ì—¬ ê°„ë‹¨í•˜ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸
"""

import streamlit as st
import sys
import os

def main():
    st.set_page_config(
        page_title="ìµœì í™”ëœ ìœ„ë²•ì„± ë¶„ì„ ì‹œìŠ¤í…œ",
        page_icon="âš–ï¸",
        layout="wide",
        initial_sidebar_state="expanded"
    )

    # ì‚¬ì´ë“œë°” ë©”ë‰´
    st.sidebar.title("ğŸ”§ ë¶„ì„ ë„êµ¬ ë©”ë‰´")

    menu_choice = st.sidebar.selectbox(
        "ì›í•˜ëŠ” ë„êµ¬ë¥¼ ì„ íƒí•˜ì„¸ìš”:",
        [
            "ğŸ  ë©”ì¸ í™ˆ",
            "ğŸ” í†µí•© ìœ„ë²•ì„± ë¶„ì„ê¸°",
            "ğŸ“‹ ë²•ë ¹ëª… ì¤‘ë³µ ì œê±° ë°ëª¨",
            "ğŸ§ª ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸",
            "ğŸ“Š ìµœì í™” ë°ëª¨"
        ]
    )

    # ë©”ì¸ í™ˆ
    if menu_choice == "ğŸ  ë©”ì¸ í™ˆ":
        show_main_home()

    # í†µí•© ë¶„ì„ê¸°
    elif menu_choice == "ğŸ” í†µí•© ìœ„ë²•ì„± ë¶„ì„ê¸°":
        st.title("ğŸ” í†µí•© ìœ„ë²•ì„± ë¶„ì„ê¸°")
        try:
            from integrated_violation_analyzer import demo_integrated_analyzer
            demo_integrated_analyzer()
        except ImportError as e:
            st.error(f"ëª¨ë“ˆ ë¡œë“œ ì˜¤ë¥˜: {e}")

    # ë²•ë ¹ëª… ì¤‘ë³µ ì œê±° ë°ëª¨
    elif menu_choice == "ğŸ“‹ ë²•ë ¹ëª… ì¤‘ë³µ ì œê±° ë°ëª¨":
        st.title("ğŸ“‹ ë²•ë ¹ëª… ì¤‘ë³µ ì œê±° ë°ëª¨")
        try:
            from law_name_deduplicator import demo_deduplication
            demo_deduplication()
        except ImportError as e:
            st.error(f"ëª¨ë“ˆ ë¡œë“œ ì˜¤ë¥˜: {e}")

    # í…ŒìŠ¤íŠ¸
    elif menu_choice == "ğŸ§ª ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸":
        show_test_results()

    # ìµœì í™” ë°ëª¨
    elif menu_choice == "ğŸ“Š ìµœì í™” ë°ëª¨":
        st.title("ğŸ“Š ìµœì í™” ë°ëª¨")
        try:
            from demo_optimized_analysis import main as demo_main
            demo_main()
        except ImportError as e:
            st.error(f"ëª¨ë“ˆ ë¡œë“œ ì˜¤ë¥˜: {e}")

def show_main_home():
    """ë©”ì¸ í™ˆ í™”ë©´"""

    st.title("âš–ï¸ ìµœì í™”ëœ ìœ„ë²•ì„± ë¶„ì„ ì‹œìŠ¤í…œ")
    st.markdown("---")

    st.markdown("""
    ## ğŸš€ ì‹œìŠ¤í…œ ê°œìš”

    ì´ ì‹œìŠ¤í…œì€ ì¡°ë¡€ì˜ ìœ„ë²•ì„± ë¶„ì„ì—ì„œ ë°œìƒí•˜ëŠ” **ë²•ë ¹ëª… ì¤‘ë³µ ë¬¸ì œ**ë¥¼ í•´ê²°í•˜ê³ ,
    **Gemini API í˜¸ì¶œì„ ìµœì í™”**í•˜ì—¬ ë¹„ìš© íš¨ìœ¨ì ì´ê³  ì •í™•í•œ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤.
    """)

    # ì£¼ìš” ê¸°ëŠ¥
    col1, col2 = st.columns(2)

    with col1:
        st.subheader("ğŸ”§ í•µì‹¬ ê¸°ëŠ¥")
        st.markdown("""
        ### 1. ë²•ë ¹ëª… ì •ê·œí™”
        - êµ­ê°€ë²•ë ¹ì •ë³´ì„¼í„° API ì—°ë™
        - ë„ì–´ì“°ê¸° ì°¨ì´ ìë™ í•´ê²°
        - 85% ì´ìƒ ìœ ì‚¬ë„ë¡œ ì¤‘ë³µ í†µí•©

        ### 2. ì§€ëŠ¥í˜• ì¤‘ë³µ ì œê±°
        - ìœ ì‚¬ë„ ê¸°ë°˜ ê·¸ë£¹í•‘
        - í‘œì¤€ ë²•ë ¹ëª… ìë™ ì„ íƒ
        - ì›ë³¸-í‘œì¤€ëª… ë§¤í•‘ ì œê³µ
        """)

    with col2:
        st.subheader("ğŸ“ˆ ìµœì í™” íš¨ê³¼")
        st.markdown("""
        ### 3. API í˜¸ì¶œ ìµœì í™”
        - ê³ ìœ„í—˜ ì‚¬ë¡€ë§Œ ì„ ë³„ (0.6 ì´ìƒ)
        - í…ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ (500ì)
        - ìƒìœ„ ë²•ë ¹ë§Œ ë¶„ì„ (5ê°œ)

        ### 4. ë¹„ìš© ì ˆê° íš¨ê³¼
        - **50-70% API í˜¸ì¶œ ì ˆì•½**
        - **ì¤‘ë³µìœ¼ë¡œ ì¸í•œ í˜¼ë€ ì œê±°**
        - **ë¶„ì„ ì •í™•ë„ í–¥ìƒ**
        """)

    st.markdown("---")

    # ì‚¬ìš© ì˜ˆì‹œ
    st.subheader("ğŸ“‹ í•´ê²°ëœ ë¬¸ì œ ì˜ˆì‹œ")

    before_after_col1, before_after_col2 = st.columns(2)

    with before_after_col1:
        st.markdown("### âŒ ê¸°ì¡´ ë¬¸ì œ")
        st.code("""
ë²•ë ¹ ëª©ë¡:
1. ê³µê³µê¸°ê´€ì˜ìš´ì˜ì—ê´€í•œë²•ë¥ 
2. ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œë²•ë¥ 
3. ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œ ë²•ë¥ 
4. ì§€ë°©ìì¹˜ë²•
5. ì§€ë°© ìì¹˜ë²•

â†’ 5ê°œ ë²•ë ¹ìœ¼ë¡œ ê°ê° ë¶„ì„
â†’ ì¤‘ë³µëœ ë‚´ìš©ìœ¼ë¡œ í˜¼ë€
â†’ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ
        """)

    with before_after_col2:
        st.markdown("### âœ… ìµœì í™” ê²°ê³¼")
        st.code("""
ì •ë¦¬ëœ ë²•ë ¹ ëª©ë¡:
1. ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œ ë²•ë¥ 
2. ì§€ë°©ìì¹˜ë²•

â†’ 2ê°œ ë²•ë ¹ìœ¼ë¡œ í†µí•© ë¶„ì„
â†’ ëª…í™•í•˜ê³  ì •í™•í•œ ê²°ê³¼
â†’ 60% API í˜¸ì¶œ ì ˆì•½
        """)

    # ì„±ê³¼ ì§€í‘œ
    st.markdown("---")
    st.subheader("ğŸ“Š ì˜ˆìƒ ì„±ê³¼")

    metric_col1, metric_col2, metric_col3, metric_col4 = st.columns(4)

    with metric_col1:
        st.metric(
            label="ì¤‘ë³µ ì œê±°ìœ¨",
            value="50-70%",
            delta="í‰ê·  60%"
        )

    with metric_col2:
        st.metric(
            label="API í˜¸ì¶œ ì ˆì•½",
            value="50-70%",
            delta="ë¹„ìš© ì ˆê°"
        )

    with metric_col3:
        st.metric(
            label="ë¶„ì„ ì •í™•ë„",
            value="í–¥ìƒ",
            delta="í˜¼ë€ ì œê±°"
        )

    with metric_col4:
        st.metric(
            label="ì²˜ë¦¬ ì†ë„",
            value="ê°œì„ ",
            delta="ë°ì´í„° ì••ì¶•"
        )

    # ì‹œì‘í•˜ê¸°
    st.markdown("---")
    st.subheader("ğŸš€ ì‹œì‘í•˜ê¸°")

    st.info("""
    **ì¶”ì²œ ì‚¬ìš© ìˆœì„œ**:
    1. **ğŸ“‹ ë²•ë ¹ëª… ì¤‘ë³µ ì œê±° ë°ëª¨** - ê¸°ë³¸ ê¸°ëŠ¥ í™•ì¸
    2. **ğŸ§ª ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸** - ì„±ëŠ¥ ê²€ì¦
    3. **ğŸ” í†µí•© ìœ„ë²•ì„± ë¶„ì„ê¸°** - ì‹¤ì œ ë¶„ì„ ì²´í—˜
    4. **ğŸ“Š ìµœì í™” ë°ëª¨** - ì „ì²´ ì‹œìŠ¤í…œ ì²´í—˜
    """)

def show_test_results():
    """í…ŒìŠ¤íŠ¸ ê²°ê³¼ í‘œì‹œ"""

    st.title("ğŸ§ª ì¤‘ë³µ ì œê±° í…ŒìŠ¤íŠ¸ ê²°ê³¼")

    st.markdown("""
    ì‹¤ì œ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì¤‘ë³µ ì œê±° ê¸°ëŠ¥ì˜ ì„±ëŠ¥ì„ í™•ì¸í•œ ê²°ê³¼ì…ë‹ˆë‹¤.
    """)

    # í…ŒìŠ¤íŠ¸ ë°ì´í„°
    st.subheader("ğŸ“ í…ŒìŠ¤íŠ¸ ë°ì´í„°")

    test_data = [
        "ê³µê³µê¸°ê´€ì˜ìš´ì˜ì—ê´€í•œë²•ë¥ ",
        "ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œë²•ë¥ ",
        "ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œ ë²•ë¥ ",
        "ì§€ë°©ìì¹˜ë²•",
        "ì§€ë°© ìì¹˜ë²•",
        "ì§€ë°©ìì¹˜ ë²•",
        "í–‰ì •ì ˆì°¨ë²•",
        "í–‰ì • ì ˆì°¨ ë²•",
        "êµ­ê°€ì¬ì •ë²•",
        "êµ­ê°€ ì¬ì •ë²•",
        "í—Œë²•"
    ]

    st.write("í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ëœ ë²•ë ¹ëª… ëª©ë¡:")
    for i, law in enumerate(test_data, 1):
        st.write(f"{i}. {law}")

    # í…ŒìŠ¤íŠ¸ ê²°ê³¼
    st.subheader("ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼")

    result_col1, result_col2, result_col3 = st.columns(3)

    with result_col1:
        st.metric("ì›ë³¸ ë²•ë ¹ ìˆ˜", "11ê°œ")

    with result_col2:
        st.metric("ì •ë¦¬ëœ ë²•ë ¹ ìˆ˜", "5ê°œ")

    with result_col3:
        st.metric("ì¤‘ë³µ ì œê±°ìœ¨", "54.5%")

    # ì¤‘ë³µ ê·¸ë£¹
    st.subheader("ğŸ” ë°œê²¬ëœ ì¤‘ë³µ ê·¸ë£¹")

    groups = [
        {
            "name": "ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œ ë²•ë¥ ",
            "members": [
                "ê³µê³µê¸°ê´€ì˜ìš´ì˜ì—ê´€í•œë²•ë¥ ",
                "ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œë²•ë¥ ",
                "ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œ ë²•ë¥ "
            ]
        },
        {
            "name": "ì§€ë°©ìì¹˜ë²•",
            "members": [
                "ì§€ë°©ìì¹˜ë²•",
                "ì§€ë°© ìì¹˜ë²•",
                "ì§€ë°©ìì¹˜ ë²•"
            ]
        },
        {
            "name": "í–‰ì •ì ˆì°¨ë²•",
            "members": [
                "í–‰ì •ì ˆì°¨ë²•",
                "í–‰ì • ì ˆì°¨ ë²•"
            ]
        },
        {
            "name": "êµ­ê°€ì¬ì •ë²•",
            "members": [
                "êµ­ê°€ì¬ì •ë²•",
                "êµ­ê°€ ì¬ì •ë²•"
            ]
        }
    ]

    for i, group in enumerate(groups, 1):
        with st.expander(f"ê·¸ë£¹ {i}: {group['name']} ({len(group['members'])}ê°œ)", expanded=False):
            st.write("**ì„ íƒëœ í‘œì¤€ëª…:**")
            st.success(f"âœ… {group['name']}")

            st.write("**ì›ë³¸ ë²•ë ¹ëª…ë“¤:**")
            for member in group['members']:
                st.write(f"- {member}")

    # ìµœì¢… ê²°ê³¼
    st.subheader("ğŸ“‹ ìµœì¢… ì •ë¦¬ëœ ë²•ë ¹ ëª©ë¡")

    final_laws = [
        "ê³µê³µê¸°ê´€ì˜ ìš´ì˜ì— ê´€í•œ ë²•ë¥ ",
        "ì§€ë°©ìì¹˜ë²•",
        "í–‰ì •ì ˆì°¨ë²•",
        "êµ­ê°€ì¬ì •ë²•",
        "í—Œë²•"
    ]

    for i, law in enumerate(final_laws, 1):
        st.write(f"{i}. {law}")

    # íš¨ê³¼
    st.success("""
    ğŸ¯ **í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½**:
    - 6ê°œ ì¤‘ë³µ ë²•ë ¹ ì •ë¦¬
    - 54.5% ë°ì´í„° ì ˆì•½
    - Gemini API í˜¸ì¶œ 6íšŒ ì ˆì•½ ì˜ˆìƒ
    - ë¶„ì„ ì •í™•ë„ ê°œì„  (ì¤‘ë³µìœ¼ë¡œ ì¸í•œ í˜¼ë€ ì œê±°)
    """)

if __name__ == "__main__":
    main()